@ECHO OFF

IF "%1"=="" GOTO NOARG

IF NOT EXIST %1\DBLBUFF.SYS GOTO BADPATH
IF NOT EXIST PATCHES\IO.SYS GOTO NOINST
ATTRIB.EXE -S -H -R C:\IO.SYS

IF EXIST C:\IO.BAK GOTO UNINST
IF EXIST %1\DBLBUFF.BAK GOTO UNINST
IF EXIST %1\SMARTDRV.BAK GOTO UNINST

IF NOT EXIST C:\IO.SYS GOTO MISSING
IF NOT EXIST %1\DBLBUFF.SYS GOTO MISSING
IF NOT EXIST %1\SMARTDRV.EXE GOTO MISSING

REN C:\IO.SYS IO.BAK
REN %1\DBLBUFF.SYS DBLBUFF.BAK
REN %1\SMARTDRV.EXE SMARTDRV.BAK

COPY PATCHES\IO.SYS C:\IO.SYS
COPY PATCHES\DBLBUFF.SYS %1\DBLBUFF.SYS
COPY PATCHES\SMARTDRV.EXE %1\SMARTDRV.EXE

ECHO TBPLUS DOS PATCHES INSTALLED SUCCESSFULLY
GOTO EXIT
:CPERR
ECHO ERROR COPYING NEW FILES
GOTO EXIT
:BKERR
ECHO ERROR RENAMING ORIGINAL FILES
GOTO EXIT
:UNINST

IF NOT EXIST C:\IO.BAK GOTO MOD
IF NOT EXIST %1\DBLBUFF.BAK GOTO MOD
IF NOT EXIST %1\SMARTDRV.BAK GOTO MOD

ECHO TBPLUS DOS PATCHES ALREADY APPLIED - RUN UNINSTD TO REMOVE
GOTO EXIT
:MOD
ECHO ONE OR MORE FILES ALREADY PATCHED - UNINSTALL PATCHES FIRST
GOTO EXIT
:MISSING
ECHO DOS FILES MISSING OR DOS DAMAGED
GOTO EXIT
:NOINST
ECHO PATCH FILE DIRECTORY NOT IN CURRENT DIRECTORY
GOTO EXIT
:BADPATH
ECHO DOS PATH INCORRECT OR DOS DAMAGED
GOTO EXIT
:NOARG
ECHO DOS DIRECTORY PATH MUST BE SPECIFIED
:EXIT
@ECHO ON
