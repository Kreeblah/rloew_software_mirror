@ECHO OFF

IF NOT EXIST %1\SYSTEM\IOSUBSYS\ESDI_506.PDR GOTO BADPATH

IF NOT EXIST %1\SYSTEM\IOSUBSYS\ESDI_506.BAK GOTO INST

IF NOT EXIST %1\SYSTEM\IOSUBSYS\ESDI_506.PDR GOTO MISSING
IF NOT EXIST %1\SYSTEM\VMM32\IOS.VXD GOTO MISSING
IF NOT EXIST %1\SYSTEM\VMM32\VFAT.VXD GOTO MISSING
IF NOT EXIST %1\INF\SATA.INF GOTO MISSING
IF NOT EXIST %1\INF\ATA0104.INF GOTO MISSING
IF NOT EXIST %1\INF\ATA0106.INF GOTO MISSING
IF NOT EXIST %1\INF\SATA0180.INF GOTO MISSING

DEL %1\SYSTEM\IOSUBSYS\ESDI_506.PDR
DEL %1\SYSTEM\VMM32\IOS.VXD
DEL %1\SYSTEM\VMM32\VFAT.VXD
DEL %1\INF\SATA.INF
DEL %1\INF\ATA0104.INF
DEL %1\INF\ATA0106.INF
DEL %1\INF\SATA0180.INF

REN %1\SYSTEM\IOSUBSYS\ESDI_506.BAK ESDI_506.PDR
REN %1\SYSTEM\VMM32\IOS.BAK IOS.VXD
REN %1\SYSTEM\VMM32\VFAT.BAK VFAT.VXD

ECHO WINDOWS TBPLUS PATCHES REMOVED SUCCESSFULLY
GOTO EXIT
:DEERR
ECHO ERROR DELETING PATCH FILES
GOTO EXIT
:BKERR
ECHO ERROR RENAMING ORIGINAL FILES
GOTO EXIT
:INST

IF EXIST %1\SYSTEM\IOSUBSYS\ESDI_506.BAK GOTO MOD
IF EXIST %1\SYSTEM\VMM32\IOS.BAK GOTO MOD
IF EXIST %1\SYSTEM\VMM32\VFAT.BAK GOTO MOD

ECHO WINDOWS TBPLUS PATCHES NOT APPLIED - RUN INSTALLW TO INSTALL
GOTO EXIT
:MOD
ECHO ONE OR MORE FILES NOT PATCHED - UNINSTALL MANUALLY
GOTO EXIT
:MISSING
ECHO WINDOWS FILES MISSING OR WINDOWS DAMAGED
GOTO EXIT
:BADPATH
ECHO WINDOWS PATH INCORRECT OR WINDOWS DAMAGED
GOTO EXIT
:EXIT
@ECHO ON
